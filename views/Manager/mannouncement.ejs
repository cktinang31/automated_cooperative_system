<!DOCTYPE html>
<html lang="en">
    <%- include("../Manager/managerhead.ejs") %>
    <link rel="stylesheet" href="/css/mannouncement.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <body>
        <%- include("../Manager/managerheader.ejs") %>
        <%- include("../Manager/managersidebar.ejs") %>
   

            <div class="container">

                <div class="form-container"> 
                    <form id="create-announcement-form" action="/post_announcement" method="POST">
                        
                            <input type="text" class="announcement-title" id="content_title" name="content_title" placeholder="Title" required>
        

                        <div class="write-container" id="writeContainer">
                            <textarea id="content" class="write-title" name="content" rows="10" placeholder="Write announcement.." required></textarea>
                        </div>

                        <div class="post-container">
                            <button type="submit" class="post-title">POST</button>
                        </div>
                    </form>

                </div>
                    <table>
                        <% if (contents && contents.length > 0) { %>
                            <% contents.forEach(content => { %>
                            <tr>
                                <td class="cooperative_advisory">
                                    <h1 class="coop_ad"><%= content.content_title %></h1>
                                    <p class="announcements"><%= content.content %></p>
                                </td>
                            </tr>
                            <% }) %>
                        <% } else { %>
                            <tr>
                                <td colspan="2" class="no-announcements">There are no announcements to display...</td>
                            </tr>
                        <% } %>
                    </table>
                    
                    
                    
                    
             
                
                
            <script>

                document.getElementById('create-announcement-form').addEventListener('submit', async function(e) {
                    e.preventDefault(); 
                    
                    const content_title = document.getElementById('content_title').value;
                    const content = document.getElementById('content').value;
                    
                    try {
                        const response = await fetch('/post_announcement', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify({ content_title, content }),
                        });
                        
                        if (response.ok) {
                            alert('Announcement Posted Successfully');
                            
                        } else {
                            alert('Error Posting Announcement');
                        }
                    } catch (error) {
                        console.error('Error posting announcement:', error);
                    }
                });

                const announcementContainer = document.getElementById('announcementContainer');
                        const announcementTitle = document.getElementById('defaultText');
                
                        announcementContainer.addEventListener('click', function() {
                        
                            if (announcementTitle) {
                                announcementTitle.style.display = 'none';
                                
                                announcementContainer.focus();
                            }
                        });
                
                        announcementContainer.addEventListener('blur', function() {
                            if (!announcementContainer.textContent.trim()) {
                                announcementTitle.style.display = 'block'; 
                            }
                        });
                
                    
                        window.addEventListener('load', function() {
                            if (!announcementContainer.textContent.trim()) {
                                announcementTitle.style.display = 'block';
                            }
                        });

                const writeContainer = document.getElementById('writeContainer');
                const writeTitle = document.getElementById('defaulttext');

                writeContainer.addEventListener('click', function() {
                    if (writeTitle) {
                        writeTitle.style.display = 'none';
                    }
                });

                        
            </script>

            


        </div>

    </body>
</html>